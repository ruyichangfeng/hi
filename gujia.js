/**
 * Created by liu on 2017/4/7.
 */
var SiteTracker=function(b,d,c,a){if(b!=undefined&&b!=null){this.site=b}if(d!=undefined&&d!=null){this.page=d}if(c!=undefined&&c!=null){this.referer=c}if(a!=undefined&&a!=null){this.uid=a}};SiteTracker.prototype.getCookie=function(a){if(!a||!this.hasItem(a)){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1"))};SiteTracker.prototype.hasItem=function(a){return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)};SiteTracker.prototype.track=function(c){this.buildParams();var f="",b,e=[],d;if(typeof(c)=="undefined"||typeof(c.target_url)=="undefined"){f=location.protocol+"//s.anjuke.com/st?__site="+this.params.site+"&"}else{f=c.target_url+"?"}for(var a in this.params){e.push(a+"="+encodeURIComponent(this.params[a]))}f+=e.join("&");b=document.createElement("script");b.src=f;b.async=true;d=(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]);b.onload=function(){d.removeChild(b)};d.appendChild(b)};SiteTracker.prototype.buildParams=function(){var a=document.location.href;var b=this.getCookie(this.nGuid||"aQQ_ajkguid");var e=this.nCtid||this.getCookie(this.nCtid||"ctid");var g=this.getCookie(this.nLiu||"lui");var d=this.getCookie(this.nSessid||"sessid");var c=this.getCookie(this.nUid||"ajk_member_id");if(this.uid!=undefined&&this.uid!=null){c=this.uid}if(c==undefined||c==null|c==""){c=0}var f="";if(this.method!=undefined&&this.method!=null){f=this.method}this.params=new Object();this.params.p=this.page;this.params.h=a;this.params.r=this.referer;this.params.site=this.site;this.params.guid=b;this.params.ssid=d;this.params.uid=c;this.params.t=new Date().getTime();this.params.ctid=e;this.params.luid=g;this.params.m=f;if(this.screen!=undefined){this.params.sc=JSON.stringify(this.screen)}if(this.cst!=undefined&&/[0-9]{13}/.test(this.cst)){this.params.lt=this.params.t-parseInt(this.cst)}if(this.pageName!=undefined){this.params.pn=this.pageName}if(this.customParam!=undefined){this.params.cp=this.customParam}};SiteTracker.prototype.setSite=function(a){this.site=a};SiteTracker.prototype.setPage=function(a){this.page=a};SiteTracker.prototype.setPageName=function(a){this.pageName=a};SiteTracker.prototype.setCookieNames=function(a){this.cookNames=a};SiteTracker.prototype.setReferer=function(a){this.referer=a};SiteTracker.prototype.setUid=function(a){this.uid=a};SiteTracker.prototype.setMethod=function(a){this.method=a};SiteTracker.prototype.setNGuid=function(a){this.nGuid=a};SiteTracker.prototype.setNCtid=function(a){this.nCtid=a};SiteTracker.prototype.setNLiu=function(a){this.nLiu=a};SiteTracker.prototype.setNSessid=function(a){this.nSessid=a};SiteTracker.prototype.setNUid=function(a){this.nUid=a};SiteTracker.prototype.setCst=function(a){this.cst=a};SiteTracker.prototype.setScreen=function(a){this.screen=a};SiteTracker.prototype.setCustomParam=function(a){this.customParam=a};SiteTracker.prototype.getParams=function(){return this.params};(function(g,k,c){var j=g.APF||{};j.Config={devLogURL:"//s.anjuke.test/ts.html?",logURL:location.protocol+"//prism.anjuke.com/ts.html?",devSojURL:"//s.anjuke.test/stb",isDev:/dev|test/.test(k.domain),blackList:["Player","baiduboxapphomepagetag","onTouchMoveInPage"]};function d(p){var m,n,o,l=j.Config.blackList;if(typeof p!=="string"){return true}for(m=0,o=l.length;m<o;m++){n=new RegExp(l[m],"g");if(n.test(p)){return true}}}function b(r){var m="tp=error&site=touch&msg=",o,n,l=[],p,q;if(typeof r==="string"){q=r}if(typeof r==="object"){for(o in r){if(r.hasOwnProperty(o)){l.push(o+":"+encodeURIComponent(JSON.stringify(r[o])))}}q=l.join(",")}if(d(q)){return false}p=new Image();if(j.Config.isDev){n=j.Config.devLogURL+m+q}else{n=j.Config.logURL+m+q}p.src=n;return true}if(!c.isFunction(g.getShareContents)){g.getShareContents=function(){return""}}g.onerror=function(n,m,l){b({message:n,url:m,line:l})};function h(l){l.preventDefault()}function e(o,n,m){var r=m||"m_anjuke",q=new SiteTracker(),t;if(n){q.setCustomParam(n)}if(window.ctid){q.setNCtid(window.ctid)}if(j.Config.isDev){t={target_url:j.Config.devSojURL}}q.setPage(o);q.setPageName(o);q.setSite(r);q.setScreen(f());q.setReferer(k.referrer);q.track(t);if(!/npv/.test(r)){var s=q.getParams();delete s.cp;delete s.sc;window._trackURL=JSON.stringify(s);var p=window._trackURL=JSON.stringify(s);l()}function l(){var v=document.createElement("script");v.type="text/javascript";v.async=true;v.src=location.protocol+"//tracklog.58.com/referrer_anjuke_m.js?_="+Math.random();var u=document.body;u.appendChild(v)}}function a(l){return("00"+l).match(/\d{2}$/)[0]}var f=function(){var l={};l.w=(g.screen.width).toString();l.h=(g.screen.height).toString();l.r=(g.devicePixelRatio>=2?1:0).toString();f=function(){return l};return l};j.Namespace={register:function(o){var n=o.split("."),l=g,p,m;for(m=0,p=n.length;m<p;m++){if(typeof l[n[m]]=="undefined"){l[n[m]]={}}l=l[n[m]]}return l}};j.Utils={setCookie:function(n,p,l,s,o,r){var m=new Date();m.setTime(m.getTime());if(l){l=l*1000*60*60*24}var q=new Date(m.getTime()+(l));k.cookie=n+"="+escape(p)+((l)?";expires="+q.toGMTString():"")+((s)?";path="+s:"")+((o)?";domain="+o:"")+((r)?";secure":"")},getCookie:function(l){var r=k.cookie.split(";"),n="",p="",q="",m,o=false;for(i=0,m=r.length;i<m;i++){n=r[i].split("=");p=n[0].replace(/^\s+|\s+$/g,"");if(p==l){o=true;if(n.length>1){q=decodeURIComponent(n[1].replace(/^\s+|\s+$/g,""))}return q;break}n=null;p=""}if(!o){return null}},deleteCookie:function(l,n,m){if(this.getCookie(l)){k.cookie=l+"="+((n)?";path="+n:"")+((m)?";domain="+m:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},touchClick:function(){var l=true;c(k).on("touchmove",function(){if(l){k.addEventListener("click",h,true);l=false}});c(k).on("touchend",function(){k.removeEventListener("click",h,true);l=true})},checkPhone:function(m){var l=/^1[3|4|5|7|8][0-9]\d{8}$/;if(l.test(m)){return true}return false},trackEvent:function(m,l){e(m,l,"m_anjuke-npv")},getGuid:function(s){s=s||"T";var m=new Date(),q=m.getMonth()+1,p=m.getDate(),l=m.getHours(),n=m.getMinutes(),r=m.getTime();var o=("xxxxxxxx-yxxx-yxxx-yxxx-"+s+"xxx").replace(/[xy]/g,function(u){var t=(r+Math.random()*16)%16|0;r=Math.floor(r/3);return(u=="x"?t:(t&7|8)).toString(16)});return(o+a(q)+a(p)+a(l)+a(n)).toUpperCase()},log:function(l){return b(l)},getCookieGuid:function(){return this.getCookie("aQQ_ajkguid")},addLinkSoj:function(m,l,o){var n=c("body");n.on("click",m,function(t){if(c(this).attr("href").indexOf("tel:")>=0){return}c(this).attr("href").indexOf("history.back")<0&&t.preventDefault();var r=c(this).data(l||"soj")||c(this).attr(l||"soj"),s=c.trim(r),p=c.trim(c(this).attr("href")),q=o||"from";if(!p){return}if(p.toLowerCase().indexOf("javascript")===0){return}t.stopPropagation();if(!s){location.href=p;return}if(p.indexOf("?")!==-1){location.href=p+"&"+q+"="+s}else{location.href=p+"?"+q+"="+s}});if(+n.data("track-npv")!==1){n.data("track-npv",1);n.on("click","[data-track-npv]",function(p){var q=c(this).data("track-npv");if(q.replace(/\s/g,"").length===0){return}e(q,"","m_anjuke-npv")})}},replaceImg:function(t,q,l){q=q?q:"data-src";l=l===false?false:true;if(!t){return false}var z=t.getAttribute(q);if(z!=""&&z!=null){var y=z.split("/").pop().match(/\d+x\d+/g);if(y){var r=parseInt(t.clientWidth),n=parseInt(t.clientHeight),p=0,x="";if(window.devicePixelRatio&&window.devicePixelRatio!=1){r=parseInt(r*window.devicePixelRatio);n=parseInt(n*window.devicePixelRatio)}if(!l){if(r>220||n>220){var u=r/220,m=n/220,p=u>m?u:m;p=Math.ceil(p);r=Math.floor(r/p);n=Math.floor(n/p)}if(p!==0){z=z.replace(/(\.\w+)$/g,"@"+p+"x$1")}}size=r+"x"+n;if(r&&n){z=z.replace(y,r+"x"+n)}}var o=new Image();o.src=z;o.onerror=function(s){t.setAttribute(q,"");return false};o.onload=function(){t.setAttribute("src",z)}}},LocalStorageHelper:function(n,m,p){try{if(n=="setItem"){localStorage[n](m,p);return true}else{var l=localStorage[n](m);return l}}catch(o){return false}},scrollHelper:function(l){var m={};c("body").on("touchstart",l,function(n){m.startTop=n.targetTouches[0].screenY;m.startScrollTop=c(this).scrollTop()});c("body").on("touchmove",l,function(o){o.preventDefault();var n=o.targetTouches[0].screenY;c(this).scrollTop(m.startScrollTop+m.startTop-n)})},sendSoj:e};(function(){var l,p,o,m,n=c("head");l=n.data("page");o=n.data("ppc");p=n.data("new-ppc");if(!p){p={};if(o){(new Image()).src=o+"&userid="+APF.Utils.getCookie("ajk_member_id")}}if(n.data("kw")){p.kw=n.data("kw")}if(n.data("soj-php")){p.test=n.data("soj-php")}if(l=="Anjuke_Prop_View"){p.datappc=o}m=location.href;if((m.indexOf("lat")!=-1)&&(m.indexOf("lng")!=-1)&&(m.indexOf("map")==-1)){p.locate="locate"}e(l,JSON.stringify(p))})();g.APF=j;g.T=j.Utils;APF.Utils.addLinkSoj("a");c(function(){if(!window.localStorage){T.trackEvent("localStorage_unsupport");return}var l=T.LocalStorageHelper("setItem","ajk_storage_test",1);if(l===false){T.trackEvent("localStorage_write_unsupport")}})})(window,document,Zepto);(function(b,a){a.CommonAutocomplete=function(c){this.defaults={limit:10,heightLightEM:true,openSlter:".commonAutocompleteOpenSlter",data_type:"json",emptyDataTips:""};this.opts=b.extend({},this.defaults,c);this.node={cancleBtn:b(".cancleBtn"),component:b(".CommonAutocompleteComponent"),commonIpt:b(".commonIpt"),list:b(".list"),historyList:b(".commu-history"),recommend:b(".common-recommend"),openSlter:b(this.opts.openSlter),emptyDataDom:b(".search-no-results")};this.init()};a.CommonAutocomplete.prototype={constructor:a.CommonAutocomplete,init:function(){var c=this;c.setNode();c.bindEvent();c.buildHistory()},setNode:function(){var c=this;if(!c.opts.wrapperSlter){return}else{b.each(c.node,function(e,d){c.node[e]=b(c.wrapperSlter).find(e)})}},bindEvent:function(){var c=this;b(document).on("click",c.opts.openSlter,function(f){c.opts.beforeShowCallback&&c.opts.beforeShowCallback(this);var d=b(this).val();c.doOneSearch(d);c.node.component.show();c.node.commonIpt.val(d).focus();b(window).scrollTop(-50);c.opts.afterShowCallback&&c.opts.afterShowCallback(this)});c.node.cancleBtn.on("click",function(d){c.node.component.hide();c.node.emptyDataDom.hide();c.opts.cancleCallback&&c.opts.cancleCallback(c)});c.node.commonIpt.on("input",function(f){var d=b(this).val();c.doOneSearch(d)});c.node.list.on("click","li",function(f){var h=b(this).attr("data-commonid");var d=b(this).find(".common-name").html().replace(/\<em\>|\<\/em\>/g,"");var g=b(this).find(".common-address").html();c.setInputed(d,g,h);b(this).siblings().hide();c.node.component.hide();c.opts.autodClickCallback&&c.opts.autodClickCallback(this)});c.node.recommend.on("click","dd",function(f){var g=b(this).attr("data-commonid");var d=b(this).children("p").text();c.setInputed(d,"",g);c.node.component.hide();c.opts.autodClickCallback&&c.opts.autodClickCallback(this)})},setInputed:function(e,h,g){var d=this;d.node.openSlter.val(e);d.node.openSlter.attr("data-addr",h||"");d.node.openSlter.attr("data-commid",g||"");var c=JSON.parse(T.LocalStorageHelper("getItem","commu_history"))||[];for(var f=0;f<c.length;f++){if(c[f].commId==g){return}if(c[f].name==e){return}}c.push({name:e.replace("<em>","").replace("</em>",""),addr:h||"",commId:g||""});T.LocalStorageHelper("setItem","commu_history",JSON.stringify(c))},doOneSearch:function(d){var c=this;var e={q:d,limit:c.opts.limit};if(c.opts.city_id!=undefined){e.city_id=c.opts.city_id}if(b.trim(d).length===0){c.node.list.empty();return}b.ajax({type:"get",url:c.opts.autoCommonApi,data:e,dataType:c.opts.data_type,success:function(f){c.node.list.empty();if(f){c.node.list.append(c.getFragment(f,d));if(c.node.commonIpt.val().length===0){c.node.list.empty()}if(f.length>0&&f[0].name==d){c.node.emptyDataDom.hide()}else{if(f.length==0){c.node.emptyDataDom.show();c.node.emptyDataDom.find("p").text(c.opts.emptyDataTips);return}else{c.node.emptyDataDom.hide()}}}},error:function(f){console.log("网络异常，请刷新重试")}})},getFragment:function(g,f){var d=this;var c=document.createDocumentFragment(),e=null;b.each(g,function(j,h){var l=h.name;if(d.opts.heightLightEM){l=l.replace(f,"<em>"+f+"</em>")}e=d.getLi();e.attr("data-commonid",h.id);e.attr("data-commonname",h.name);e.attr("data-addr",h.address);e.children(".common-name").html(l);var m="";if(h.area_name!=undefined){m=h.area_name+" "}e.find(".common-address").html(m+h.address);c.appendChild(e[0])});return c},buildHistory:function(){var d=this,f="";var c=JSON.parse(T.LocalStorageHelper("getItem","commu_history"))||[];for(var e=0;e<10;e++){var h="",g="";if(c[e]){if(c[e].commId>0){h=c[e].commId;g=c[e].addr}f+='<dd data-commonid="'+h+'" data-commonname="'+c[e].name+'" data-addr="'+g+'"><p>'+c[e].name+"</p></dd>"}}f.length&&d.node.historyList.show().append(b(f))},getLi:function(){return b('<li data-commonid=""><p class="common-name"></p><address class="common-addr"><p class="common-address"></p></address></li>')}}})(Zepto,APF.Namespace.register("touch.component.module"));(function(b,a){a.Observer={listener:{defaults:[]},data_status:{},on:function(d,c){if(b.type(d)==="function"){d="defaults";c=d}if(b.type(c)!=="function"){return}if(!this.listener[d]){this.listener[d]=[]}this.listener[d].push(c)},off:function(g,f){var e,d,c;if(b.type(g)==="function"){f=g;g="defaults"}if(!g){return}e=this.listener[g];c=e?e.length:0;if(b.type(f)==="function"){for(d=0;d<c;d++){if(e[d]===f){e.splice(d,1)}}this.listener[g]=e;return}this.listener[g]=[]},trigger:function(){var j=arguments.length,h,g,e=[],d,c,f;if(j<=1){h=b.type(arguments[0]);if(h==="array"){h="defaults";e=h}else{if(h!=="string"){return}else{h=arguments[0]}}}else{e=[].concat.apply([],arguments);h=e.splice(0,1)}g=this.listener[h];d=g?g.length:0;for(f=0;f<d;f++){c=g[f].apply(null,e);if(c===false){break}}},get_data:function(c){return this.data_status[c]},set_data:function(c,d){this.data_status[c]=d}};a.Observer.addPublisher=function(c){b.extend(true,c,a.Observer)}})(Zepto,APF.Namespace.register("touch.component.module"));(function(c,b){var a={time:1500,className:"touch-tips"};b.tips=function(h,f){var g=c(window).scrollTop();var e=a.className;var d=c('<p class="'+e+'"></p>');c("."+e).remove();c("body").append(d);setTimeout(function(){c("body").scrollTop(g+1);setTimeout(function(){c("body").scrollTop(g)},10)},1);d.show();d.text(h);window.touchTip=setTimeout(function(){d.addClass("fadeOut");window.touchTip=undefined;setTimeout(function(){d.hide()},2000)},a.time)};b.setTipsOption=function(d){a=c.extend(a,d)}})(Zepto,APF.Namespace.register("touch.component.module"));(function(a){a.introDialog=function(c){var b={wrap_maxheight:"390px",title_height:"40px",cont:$("<div></div>")};this.dom={},this.ops=$.extend({},b,c);this.init()};a.introDialog.prototype={constructor:a.introDialog,init:function(){var b=this;b.dom.mask=$('<div class="ui-tw-idmask"></div>');b.dom.contdiv=$('<div class="ui-tw-idcon"></div>');b.dom.header=$('<div class="ui-tw-idcon-title"><i></i></div>');b.dom.contbody=$('<div class="ui-tw-idcon-body"></div>').append(b.ops.cont.show());b.dom.contdiv.append(b.dom.header).append(b.dom.contbody);$("body").append(b.dom.mask).append(b.dom.contdiv);b.dom.contdiv.css({"max-height":b.ops.wrap_maxheight});b.dom.header.css({height:b.ops.title_height,"line-height":b.ops.title_height});b.dom.contbody.css({"max-height":parseInt(b.ops.wrap_maxheight)-parseInt(b.ops.title_height)});T.scrollHelper("."+b.dom.contbody.attr("class"));b._bindEvent()},_bindEvent:function(){var b=this;b.dom.mask.on("click",function(){b.close()});b.dom.mask.on("touchmove",function(c){c.preventDefault()});b.dom.header.on("click",function(){b.close()})},_appendCont:function(b){this.dom.contbody.append(b)},open:function(){var b=this;b.dom.mask.show();b.dom.contdiv.show();setTimeout(function(){b.dom.contdiv.addClass("ui-tw-idconShow")},0)},close:function(){var b=this;b.dom.contdiv.removeClass("ui-tw-idconShow");setTimeout(function(){b.dom.contdiv.hide();b.dom.mask.hide()},400)}}})(APF.Namespace.register("touch.component.module"));window.MultiSlter=window.MultiSlter||{};(function(b,a){a.MultiSlter=function(c){this.defaults={autoScrollInterval:500,slideDownInterval:0,datas:null,cancleTip:"请选择",separator:"-",sltedClassName:"selected"};this.ops=b.extend({},this.defaults,c);this.nodes={multiSlterMask:b("#multiSlterMask"),multislterItem:null,openNode:b(this.ops.openSlter),cancleBtn:null,confirmBtn:null};this.scrollObj=[];this.sltedAry=null;this.innerHeight=window.innerHeight;this.init()};a.MultiSlter.prototype.init=function(){var c=this;c.initScrollItems();c.bindEvent()};a.MultiSlter.prototype.bindEvent=function(){var c=this;document.addEventListener("touchmove",function(d){if(c.preventTouchmove){d.preventDefault()}},false);c.nodes.openNode.on("click",function(d){c.show()});c.nodes.cancleBtn.on("click",function(f){var d=b(c.scrollObj[0].scroller.parentNode.parentNode).find("."+c.ops.sltedClassName);c.ops.cancleCallback&&c.ops.cancleCallback(d,c);c.hide()});c.nodes.confirmBtn.on("click",function(h){c.sltedAry=b(c.scrollObj[0].scroller.parentNode.parentNode).find("."+c.ops.sltedClassName);var f={autoInster:true,autoHide:true};if(c.ops.confirmCallback){f=b.extend({},f,c.ops.confirmCallback(c.sltedAry,c))}var d="";b.each(c.scrollObj,function(j,e){var l=b(e.scroller).children("."+c.ops.sltedClassName).html();if(l!==c.ops.cancleTip){d+=l+c.ops.separator}});if(f.autoInster){var g=new RegExp(c.ops.separator+"$");c.nodes.openNode.html(d.replace(g,""));if(d===""){c.nodes.openNode.html(c.nodes.openNode.attr("data-holder")).addClass("multislter-holder")}else{c.nodes.openNode.removeClass("multislter-holder")}}if(f.autoHide){c.hide()}})};a.MultiSlter.prototype.initScrollItems=function(){var c=this;if(!c.nodes.openNode.attr("data-holder")){c.nodes.openNode.attr("data-holder",c.nodes.openNode.html())}if(c.nodes.multiSlterMask.length===0){b("body").append(b('<div class="multislter-mask none" id="multiSlterMask"></div>'));c.nodes.multiSlterMask=b("#multiSlterMask")}var e=b('<div class="multislter-item slter-hide"><div class="action-wrap"><span class="cancleBtn">取消</span><span class="confirmBtn">确定</span></div></div>');var d=b('<div class="slter-wrap"></div>');b.each(c.ops.datas,function(f,j){var g=b('<div class="list-wrap"></div>');var h=b("<ul></ul>");b.each(j,function(l,n){var m=b("<li></li>");b.each(n,function(k,o){if(k==="htmlData"){m.html(o)}else{m.data(k,o)}});h.append(m)});d.append(g.append(h))});e.append(d);c.nodes.multiSlterMask.append(e);c.nodes.multislterItem=e;c.nodes.cancleBtn=e.find(".cancleBtn");c.nodes.confirmBtn=e.find(".confirmBtn")};a.MultiSlter.prototype.show=function(){var c=this;c.nodes.multiSlterMask.removeClass("none");if(navigator.userAgent.indexOf("Safari")===-1){}else{c.nodes.multiSlterMask[0].style.height=window.innerHeight+"px";if(window.innerHeight<c.innerHeight){c.nodes.multiSlterMask[0].style.height=c.innerHeight+"px"}}setTimeout(function(){c.nodes.multislterItem.removeClass("slter-hide");b.each(c.nodes.multislterItem.find("ul"),function(e,g){if(+b(g).data("scrolled")!==1){var d=b('<li data-value="-1"></li>').html(c.ops.cancleTip);b(g).append('<li class="last"></li>').prepend(d);c.scrollObj[e]=new IScroll(b(g).parent()[0],{tap:true});b(g).data("scrolled","1");b(g).on("tap","li",function(k){var h=true;if(c.ops.liTapCallback){var j=b(c.scrollObj[0].scroller.parentNode.parentNode).find("."+c.ops.sltedClassName);h=c.ops.liTapCallback(this,g,j,c.scrollObj[e],c.scrollObj)}if(h!==false&&this.innerHTML){b(this).addClass(c.ops.sltedClassName).siblings().removeClass(c.ops.sltedClassName)}})}c.scrollObj[e].refresh();var f=c.nodes.openNode.html();if(f!==c.ops.cancleTip){if(f){c.sltersGoTo(f.split(c.ops.separator))}}});c.ops.showCallback&&c.ops.showCallback(c);c.preventTouchmove=true},10)};a.MultiSlter.prototype.hide=function(){var c=this;c.nodes.multislterItem.addClass("slter-hide");setTimeout(function(){if(c.ops.autoScrollInterval){b.each(c.scrollObj,function(e,d){var f=b(d.scroller).children()[0];d.scrollToElement(f)})}c.nodes.multiSlterMask.addClass("none")},c.ops.slideDownInterval);c.preventTouchmove=false};a.MultiSlter.prototype.sltersGoTo=function(e){var c=this;var d=e;var f=false;if(c.scrollObj.length!==e.length&&c.sltedAry){d=c.sltedAry;f=true}b.each(c.scrollObj,function(j,h){var l=b(h.scroller).children();var n=l[0];for(var m=0,g=l.length;m<g;++m){var o=f?d[j].innerHTML:d[j];if(l[m].innerHTML===o){n=l[m];break}}if(n){b(n).addClass(c.ops.sltedClassName).siblings().removeClass(c.ops.sltedClassName);h.scrollToElement(n,c.ops.autoScrollInterval)}})};a.MultiSlter.prototype.sltersGoToLi=function(c){var d=this;b.each(d.scrollObj,function(f,e){b(c).addClass(d.ops.sltedClassName).siblings().removeClass(d.ops.sltedClassName);e.scrollToElement(c,d.ops.autoScrollInterval)})};window.MultiSlter.setSltedIptVal=function(e,f){var c=e.length;if(!b.isArray(e)){f[0]&&(b("[name="+e+"]").val(f[0].dataset.value||""))}else{for(var d=0,c=e.length;d<c;++d){f[d]&&(b("[name="+e[d]+"]").val(f[d].dataset.value||""))}}};window.MultiSlter.getSlterData=function(k,l,f,d,j,e){var c=[];for(var h=k;h<=l;++h){var g={htmlData:(f||"")+h+(d||""),value:h};if(j&&e){g[j]=e}c.push(g)}return c}})(Zepto,APF.Namespace.register("ajk.module"));(function(a,c){var b=a.form=function(d){this.ops=$.extend({},d);this.dom={form:$(".form"),tags:$(".fy-tags"),selects:$("select"),submitBtn:$("#submit_btn"),aboutBtn:$(".assess-article"),assessAbout:$(".introDialog-wrap"),commuSelectBtn:$("#search-comm")};this.init();this.acts();this.initSlter()};b.prototype.init=function(){var d=this;d.introDialog=new touch.component.module.introDialog({cont:d.dom.assessAbout});d.recoverTags();d.checkSubmitBtn()};b.prototype.acts=function(){var d=this;d.dom.tags.on("click",function(){$(this).toggleClass("active");d.collectTags()});$('input[name="area"]').on("blur",function(){$(this).val(new Number($(this).val()).toFixed(1)*100/100)});d.dom.form.find("input.required").on("input",function(){d.checkSubmitBtn()});d.dom.submitBtn.on("click",function(){var e;if($(this).hasClass("dis-btn")){d.checkRequired()}else{if(d.checkFormat()){T.trackEvent("gj_bdsjgy");d.dom.form.submit()}}});d.dom.aboutBtn.on("click",function(){d.introDialog.open();T.trackEvent("gj_ggytc")});d.dom.commuSelectBtn.on("click",function(){T.trackEvent("gj_xqxz")});d.dom.selects.val("")};b.prototype.initSlter=function(){var d=this;var g=[MultiSlter.getSlterData(1,60,"","层","type","floor"),MultiSlter.getSlterData(1,60,"共","层","type","allfloor")];d.initSlterVal(["pro_floor","floor"],g,"#floorSlter");d.floorSlter=new ajk.module.MultiSlter({openSlter:"#floorSlter",datas:g,confirmCallback:function(j,h){MultiSlter.setSltedIptVal(["pro_floor","floor"],j);d.checkSubmitBtn()},cancleCallback:function(j,h){h.nodes.multiSlterMask.find(".disabled").removeClass("disabled")},showCallback:function(j){var k=j.scrollObj[0].scroller;var h=$(k).find(".selected");if(+h.data("value")!==-1){h.trigger("tap")}},liTapCallback:function(u,q,p,o,k){var n=$(u);var m=$(p[0]).data("value");var l=$(p[1]).data("value");var s=n.data("type");var h="";var t="";var v=k[1].scroller;if(s==="floor"){h=+(n.data("value")||0);$.each($(v).children(),function(x,w){if(+($(w).data("value")||0)<h){$(w).addClass("disabled")}else{$(w).removeClass("disabled")}});var j=$(v).find(".selected").data("value");if(h<=j){return}var r=$(v).children()[h];k[1].scrollToElement(r);$(r).trigger("tap")}else{if(n.hasClass("disabled")){return false}}}});var e=[[{htmlData:"东",value:"1"},{htmlData:"南",value:"2"},{htmlData:"西",value:"3"},{htmlData:"北",value:"4"},{htmlData:"东南",value:"5"},{htmlData:"东北",value:"6"},{htmlData:"西南",value:"7"},{htmlData:"西北",value:"8"},]];d.initSlterVal(["orient"],e,"#orientSlter");d.orientSlter=new ajk.module.MultiSlter({openSlter:"#orientSlter",datas:e,confirmCallback:function(j,h){MultiSlter.setSltedIptVal("orient",j);d.checkSubmitBtn()}});var f=[MultiSlter.getSlterData(1,9,"","室"),MultiSlter.getSlterData(1,9,"","厅"),MultiSlter.getSlterData(1,9,"","卫")];d.initSlterVal(["rooms","livings","toilets"],f,"#houseTypeSlter"," ");d.houseTypeSlter=new ajk.module.MultiSlter({openSlter:"#houseTypeSlter",datas:f,separator:" ",confirmCallback:function(j,h){MultiSlter.setSltedIptVal(["rooms","livings","toilets"],j);d.checkSubmitBtn()}})};b.prototype.initSlterVal=function(h,l,j,k){var e=this;var g="";var f=false;var k=k||"-";$.each(h,function(m,o){var p=$("[name="+o+"]").val();if(!p){f=true}var n=l[m];$.each(n,function(r,q){if(q.value==p){g=g+q.htmlData+k}})});var d=g.replace(new RegExp(k+"$"),"");if(!f){$(j).removeClass("multislter-holder").html(d)}return d};b.prototype.collectTags=function(){var e=this,d="";e.dom.tags.filter(".active").each(function(){d+=$(this).data("val")+","});$("input[name=tags]").val(d.substring(0,d.length-1))};b.prototype.recoverTags=function(){var e=this,f=e.getVal("tags");if(!f.length){return}var d=f.split(",");$.each(d,function(g){e.dom.tags.eq(+d[g]-1).addClass("active")})};b.prototype.checkSubmitBtn=function(){var m=this,k=m.getVal("comm_id"),d=m.getVal("area"),f=m.getVal("rooms"),g=m.getVal("livings"),e=m.getVal("toilets"),h=m.getVal("orient"),l=m.getVal("pro_floor"),j=m.getVal("floor"),n=m.getVal("tags");if(k.length&&d.length&&f.length&&f!=="-1"&&g.length&&g!=="-1"&&e.length&&e!=="-1"&&l.length&&l!=="-1"&&j.length&&j!=="-1"&&h.length&&h!=="-1"){m.dom.submitBtn.removeClass("dis-btn")}else{m.dom.submitBtn.addClass("dis-btn")}};b.prototype.checkRequired=function(){var m=this,k=m.getVal("comm_id"),d=m.getVal("area"),f=m.getVal("rooms"),g=m.getVal("livings"),e=m.getVal("toilets"),h=m.getVal("orient"),l=m.getVal("pro_floor"),j=m.getVal("floor"),n=m.getVal("tags");if(!k.length||k==="0"){m.showErr("请输入小区");return}if(!d.length||d==="0"){m.showErr("请输入房屋面积");return}if(!+f||!+g||!+e||f==="-1"||g==="-1"||e==="-1"){m.showErr("请输入户型");return}if(!h.length||h==="-1"){m.showErr("请选择房屋朝向");return}if(!l.length||l==="-1"){m.showErr("请选择楼层数");return}if(!j.length||j==="-1"){m.showErr("请选择总楼层数");return}};b.prototype.checkFormat=function(){var d=this,f=d.getVal("area"),g=d.getVal("pro_floor"),e=d.getVal("floor");if(f>9999||f<1||isNaN(f)){d.showErr("房屋面积范围1至9999m²");return false}if(+e<+g){d.showErr("总楼层数必须大于等于楼层数");return false}return true};b.prototype.getVal=function(d){return $('[name="'+d+'"]').val()};b.prototype.showErr=function(d){touch.component.module.tips(d)}})(APF.Namespace.register("touch.assess"),window);